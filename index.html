<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="FunaTrace helps you find every address in Sh. Funadhoo with pinpoint accuracy. The island's most reliable location finder.">
  
  <!-- PWA Metadata -->
  <link rel="manifest" href="https://ahmedsharyph.github.io/funatrace/manifest.json">
  <link rel="apple-touch-icon" href="https://ahmedsharyph.github.io/funatrace/ft_logo.png">
  <meta name="theme-color" content="#00bcd4">
</head>
<body>
<script>
  // Function to check if PWA is installed
  function isPWAInstalled() {
    return window.matchMedia('(display-mode: standalone)').matches || 
           window.navigator.standalone === true ||
           document.referrer.includes('android-app://');
  }

  // Function to handle install completion
  function handleInstallComplete() {
    // Only redirect if not installed and first visit in this session
    if (!isPWAInstalled() && !sessionStorage.getItem('installAttempted')) {
      sessionStorage.setItem('installAttempted', 'true');
      window.location.href = "https://www.ahmedsharyph.mv/p/funatrace-v3.html";
    }
  }

  // Check immediately if already installed (no need to wait for install.js)
  if (isPWAInstalled()) {
    // Optionally do something different for installed users
  } else {
    // Load the install script
    const script = document.createElement('script');
    script.src = "https://ahmedsharyph.github.io/funatrace/install.js";
    script.defer = true;
    script.onload = handleInstallComplete;
    document.body.appendChild(script);
  }
</script>
</body>
</html>
